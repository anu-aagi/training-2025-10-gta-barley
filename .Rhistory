#| include: false
# R packages
library(readxl)
library(tidyverse)
# Data
raw_data <- read_excel(here("data/data-raw/Copy of GTA Assesment Protocol Test_Zoomagri_ShrdMrsdn.xlsx"), sheet = "Clean")
#| include: false
# R packages
library(here)
library(readxl)
library(janitor)
library(tidyverse)
# Data
raw_data <- read_excel(here("data/data-raw/Copy of GTA Assesment Protocol Test_Zoomagri_ShrdMrsdn.xlsx"), sheet = "Clean")
# Data
raw_data <- read_excel(here("data/data-raw/Copy of GTA Assesment Protocol Test_Zoomagri_ShrdMrsdn.xlsx"), sheet = "Clean") |> clean_names()
raw_data
raw_data
raw_data |>
select(-ends_with("date"))
#| code-fold: true
#| echo: true
# Data
raw_data <- read_excel(here("data/data-raw/Copy of GTA Assesment Protocol Test_Zoomagri_ShrdMrsdn.xlsx"), sheet = "Clean") |>
clean_names() |> # Turn all column names to lower, snakecase
rename(result_1_percent = percent_12, # Give percent results a more relevant name
result_2_percent = percent_14,
result_3_percent = percent_16)
raw_data |>
select(-ends_with("date"))
raw_data |>
select(workstation, sample_code, classified_seeds, result_1:result_3)
library(kableExtra)
raw_data |>
select(workstation, sample_code,result_1:result_3) |>
kable()
raw_data |>
count(workstation)
raw_data |>
count(workstation, analysis_id)
raw_data |>
count(workstation, analysis_id, sample_code)
raw_data |>
count(workstation, sample_code)
raw_data
raw_data |>
count(workstation, sample_code) |>
arrange(-n)
raw_data |>
count(workstation)
raw_data |>
count(workstation, sample_code) |>
arrange(-n)
raw_data |>
count(sample_code)
raw_data |>
count(workstation)
raw_data |>
count(sample_code)
raw_data |>
count(sample_code) |>
arrange(-n)
raw_data |>
count(sample_code)
raw_data |>
count(workstation, sample_code) |>
arrange(-n)
raw_data |>
count(workstation)
raw_data |>
count(sample_code)
raw_data |>
count(sample_code) |>
print(n = Inf)
raw_data |>
drop_na(workstation) |>
count(workstation)
raw_data |>
drop_na(workstation, sample_code) |>
count(sample_code)
raw_data |>
drop_na(workstation, sample_code) |>
count(sample_code) |>
print(n = 100)
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
count(sample_code)
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
count(sample_code) |>
print(n = 100)
?recode
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_match(sample_code,
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
count(sample_code)
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(sample_code,
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
count(sample_code)
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
count(sample_code)
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
count(sample_code) |>
print(n = 100)
raw_data_precursory_clean <- raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
)
raw_data_precursory_clean |>
janitor::get_one_to_one()
?get_one_to_one()
raw_data |>
select(number_samples, expected_result)
raw_data_precursory_clean |>
count(number_samples)
raw_data |>
janitor::add_totals_col()
raw_data |>
janitor::adorn_totals()
?adorn_totals
raw_data |>
janitor::adorn_totals() |>
tibble()
raw_data |>
janitor::remove_constant()
raw_data |>
count(sample_code)
janitor::remove_constant
raw_data_precursory_clean <- raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
janitor::remove_constant()
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
janitor::remove_constant()
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
janitor::remove_constant() |>
select(-c(pc_id, s_n))
raw_data
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
janitor::remove_constant() |>
select(-c(pc_id, s_n))
raw_data_precursory_clean |>
select(-c(pc_id, s_n, ends_with("date")))
raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
janitor::remove_constant() |>
select(-c(pc_id, s_n, ends_with("date")))
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent")
raw_data_cursory_clean <- raw_data |>
drop_na(workstation, sample_code) |>
filter(str_detect(sample_code, "Mix|Pure")) |>
mutate(sample_code =
case_when(
str_detect(sample_code, "Repeat") ~ "GTAPure10",
.default = sample_code
),
) |>
janitor::remove_constant() |>
select(-c(pc_id, s_n, ends_with("date")))
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent")
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent") |>
filter(result == str_remove(result_percent, "_percent"))
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent")
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent") |>
filter(result == str_remove(result_percent, "_percent"))
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent")
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent") |>
filter(result == str_remove(result_percent, "_percent"))
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent") |>
filter(result == str_remove(result_percent, "_percent")) |>
mutate(result_top = str_remove(result, "result_"))
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent") |>
filter(result == str_remove(result_percent, "_percent")) |>
mutate(result_top = str_remove(result, "result_")) |>
select(-result, -result_percent)
raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent") |>
filter(result == str_remove(result_percent, "_percent")) |>
mutate(result_top = str_remove(result, "result_")) |>
select(-result, -result_percent)  |>
filter(!is.na(variety))
gta_tidy <- raw_data_cursory_clean |>
mutate(obs_id = 1:n()) |>
pivot_longer(cols = c(result_1, result_2, result_3),
values_to = "variety",
names_to = "result") |>
pivot_longer(cols = starts_with("result_"),
names_to = "result_percent",
values_to = "percent") |>
filter(result == str_remove(result_percent, "_percent")) |>
mutate(result_top = str_remove(result, "result_")) |>
select(-result, -result_percent)  |>
filter(!is.na(variety))
gta_tidy
# add varieties with zero percent -------------------------------------------------
varieties <- c("Planet", "Spartacus CL", "Westminster", "Bass", "Maximus CL",
"La Trobe", "Commodus CL")
varieties_zero <- expand_grid(variety = varieties, percent = 0, obs_id = unique(gta_tidy$obs_id))
missing_zeroes <- varieties_zero |>
anti_join(select(gta_tidy, variety, percent, starts_with("result"), obs_id), by = c("obs_id", "variety"))
missing_zeroes
select(gta_tidy, variety, percent, starts_with("result"), obs_id)
varieties_zero
missing_zeroes
bind_rows(gta_long, missing_zeroes)
input <- bind_rows(gta_tidy, missing_zeroes) |>
arrange(obs_id) |>
fill(-result_top)
input
gta_tidy
raw_data_cursory_clean
geom_histogram()
ggplot(raw_data_cursory_clean, aes(x = classified_seeds)) +
geom_histogram()
ggplot(raw_data_cursory_clean, aes(x = classified_seeds)) +
geom_histogram(fill = NA)
ggplot(raw_data_cursory_clean, aes(x = classified_seeds)) +
geom_histogram(colour = "white")
